# í”„ë¡œì íŠ¸ ì„¤ëª… ë¬¸ì„œ (ì´ì „ ë²„ì „)

---

## ì²« í˜ì´ì§€

| í•­ëª©                     | ë‚´ìš©                                                      |
| ------------------------ | --------------------------------------------------------- |
| **ê³¼ëª©ëª…**               | ê³ ê¸‰ì›¹í”„ë¡œê·¸ë˜ë° (Advanced Web Programming)               |
| **í”„ë¡œì íŠ¸ ì´ë¦„ (ì£¼ì œ)** | Thomas Anderson - ê³µë™êµ¬ë§¤ í”Œë«í¼ (Group Buying Platform) |
| **ì´ë¦„**                 | ìµœì›ë¹ˆ                                                    |
| **í•™ë²ˆ**                 | 60203042                                                  |

---

## 1. í”„ë¡œì íŠ¸ ê°œìš”

**Thomas Anderson**ëŠ” ëª…ì§€ëŒ€í•™êµ í•™ìƒë“¤ì„ ìœ„í•œ ê³µë™êµ¬ë§¤ í”Œë«í¼ì…ë‹ˆë‹¤. í•™ìƒë“¤ì´ ìƒí’ˆì„ ê³µë™ìœ¼ë¡œ êµ¬ë§¤í•˜ì—¬ í• ì¸ í˜œíƒì„ ëˆ„ë¦´ ìˆ˜ ìˆë„ë¡ ì§€ì›í•˜ë©°, ì‹¤ì‹œê°„ ì±„íŒ…, ì‹ ë¢°ì ìˆ˜ ì‹œìŠ¤í…œ, ì¹´í…Œê³ ë¦¬ í•„í„°ë§ ë“± ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

### ê¸°ìˆ  ìŠ¤íƒ

- **Backend**: Node.js, Express.js, TypeScript
- **Database**: MySQL (Sequelize ORM)
- **Real-time**: Socket.io
- **Authentication**: Passport.js (Local, Kakao)
- **API Documentation**: Swagger
- **Frontend**: Bootstrap, Handlebars, Vanilla JavaScript

---

## 2. ì½”ë“œ êµ¬ì„± (í´ë” ë³„ ì†ŒìŠ¤ì½”ë“œ ì´ë¦„ ë° ê¸°ëŠ¥ ì„¤ëª…)

### ğŸ“ `src/` - ì†ŒìŠ¤ì½”ë“œ ë£¨íŠ¸ ë””ë ‰í† ë¦¬

#### ğŸ“ `server.ts` - ì„œë²„ ì§„ì…ì 

- Express ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ë™
- ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ë° ì´ˆê¸°í™”
- Socket.io ì„œë²„ ì„¤ì •
- HTTP ì„œë²„ ì‹œì‘

#### ğŸ“ `app.ts` - Express ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì •

- ë¯¸ë“¤ì›¨ì–´ ì„¤ì • (CORS, Body Parser, Session, Passport)
- ì •ì  íŒŒì¼ ì œê³µ
- ë¼ìš°í„° ë“±ë¡
- ê¸€ë¡œë²Œ ì—ëŸ¬ í•¸ë“¤ëŸ¬
- Swagger ë¬¸ì„œ ì„¤ì •

---

### ğŸ“ `routes/` - API ë¼ìš°íŠ¸ ì •ì˜

#### ğŸ“ `routes/index.ts` - ë¼ìš°íŠ¸ í†µí•©

- ëª¨ë“  API ë¼ìš°í„°ë¥¼ `/api` ê²½ë¡œ í•˜ìœ„ì— í†µí•©
- User, Post, Upload, Chat, Notification ë¼ìš°í„° ë“±ë¡

#### ğŸ“ `routes/users/UserRoutes.ts` - ì‚¬ìš©ì ê´€ë ¨ API

- `GET /api/users` - ì „ì²´ ì‚¬ìš©ì ì¡°íšŒ (í˜ì´ì§•)
- `POST /api/users` - íšŒì›ê°€ì…
- `POST /api/users/login` - ë¡œê·¸ì¸ (í•™ë²ˆ + ë¹„ë°€ë²ˆí˜¸)
- `GET /api/users/:id` - ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ
- `PUT /api/users/:id` - íšŒì› ì •ë³´ ìˆ˜ì •
- `DELETE /api/users/:id` - íšŒì› ì‚­ì œ
- `GET /api/users/:userId/favorites` - ê´€ì‹¬ ë“±ë¡í•œ ê²Œì‹œê¸€ ëª©ë¡

#### ğŸ“ `routes/posts/PostRoutes.ts` - ê²Œì‹œê¸€ ê´€ë ¨ API

- `GET /api/posts` - ì „ì²´ ê²Œì‹œê¸€ ì¡°íšŒ (ì¹´í…Œê³ ë¦¬ í•„í„°ë§, í˜ì´ì§•)
- `GET /api/posts/student/:studentId` - í•™ë²ˆë³„ ê²Œì‹œê¸€ ì¡°íšŒ
- `GET /api/posts/:id` - ê²Œì‹œê¸€ ìƒì„¸ ì¡°íšŒ
- `POST /api/posts` - ê²Œì‹œê¸€ ë“±ë¡
- `PUT /api/posts/:id` - ê²Œì‹œê¸€ ìˆ˜ì •
- `PATCH /api/posts/:id/status` - ê²Œì‹œê¸€ ìƒíƒœ ë³€ê²½
- `DELETE /api/posts/:id` - ê²Œì‹œê¸€ ì‚­ì œ
- `POST /api/posts/:id/participate` - ê³µë™êµ¬ë§¤ ì°¸ì—¬
- `DELETE /api/posts/:id/participate/:userId` - ì°¸ì—¬ ì·¨ì†Œ
- `GET /api/posts/:id/participants` - ì°¸ì—¬ì ëª©ë¡
- `POST /api/posts/:postId/favorite` - ê´€ì‹¬ ë“±ë¡
- `DELETE /api/posts/:postId/favorite/:userId` - ê´€ì‹¬ í•´ì œ

#### ğŸ“ `routes/chat/ChatRoutes.ts` - ì±„íŒ… ê´€ë ¨ API

- `POST /api/chat/rooms` - ì±„íŒ…ë°© ìƒì„±
- `GET /api/chat/rooms/user/:userId` - ì‚¬ìš©ìì˜ ì±„íŒ…ë°© ëª©ë¡
- `GET /api/chat/rooms/post/:postId` - ê²Œì‹œê¸€ë³„ ì±„íŒ…ë°© ì¡°íšŒ/ìƒì„±
- `GET /api/chat/rooms/:id` - ì±„íŒ…ë°© ìƒì„¸ ì¡°íšŒ
- `POST /api/chat/messages` - ë©”ì‹œì§€ ì „ì†¡
- `GET /api/chat/rooms/:chatRoomId/messages` - ë©”ì‹œì§€ ëª©ë¡ ì¡°íšŒ
- `PATCH /api/chat/messages/:id/read` - ë©”ì‹œì§€ ì½ìŒ ì²˜ë¦¬
- `PATCH /api/chat/rooms/:chatRoomId/read-all` - ì „ì²´ ì½ìŒ ì²˜ë¦¬
- `GET /api/chat/rooms/:chatRoomId/unread-count` - ì½ì§€ ì•Šì€ ë©”ì‹œì§€ ìˆ˜

#### ğŸ“ `routes/upload/UploadRoutes.ts` - íŒŒì¼ ì—…ë¡œë“œ API

- `POST /api/upload/image` - ì´ë¯¸ì§€ ì—…ë¡œë“œ (Multer)

#### ğŸ“ `routes/notifications/NotificationRoutes.ts` - ì•Œë¦¼ ê´€ë ¨ API

- `GET /api/notifications/user/:userId` - ì‚¬ìš©ì ì•Œë¦¼ ëª©ë¡
- `PATCH /api/notifications/:id/read` - ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬

#### ğŸ“ `routes/auth/AuthRoutes.ts` - ì¸ì¦ ê´€ë ¨ ë¼ìš°íŠ¸

- `POST /auth/login` - ì„¸ì…˜ ê¸°ë°˜ ë¡œê·¸ì¸ (Local, Kakao)
- `POST /auth/logout` - ë¡œê·¸ì•„ì›ƒ

#### ğŸ“ `routes/common/validation/` - ìš”ì²­ ê²€ì¦ ìŠ¤í‚¤ë§ˆ

- `parseReq.ts` - Zodë¥¼ ì´ìš©í•œ ìš”ì²­ ê²€ì¦ ìœ í‹¸ë¦¬í‹°
- `user-schemas.ts` - ì‚¬ìš©ì ê´€ë ¨ ìŠ¤í‚¤ë§ˆ
- `post-schemas.ts` - ê²Œì‹œê¸€ ê´€ë ¨ ìŠ¤í‚¤ë§ˆ
- `chat-schemas.ts` - ì±„íŒ… ê´€ë ¨ ìŠ¤í‚¤ë§ˆ
- `post-status-schemas.ts` - ê²Œì‹œê¸€ ìƒíƒœ ë³€ê²½ ìŠ¤í‚¤ë§ˆ

---

### ğŸ“ `controllers/` - ì»¨íŠ¸ë¡¤ëŸ¬ (ìš”ì²­ ì²˜ë¦¬ ë¡œì§)

- `user.controller.ts` - ì‚¬ìš©ì ê´€ë ¨ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬
- `post.controller.ts` - ê²Œì‹œê¸€ ê´€ë ¨ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬
- `chat.controller.ts` - ì±„íŒ… ê´€ë ¨ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬
- `favorite.controller.ts` - ê´€ì‹¬ ë“±ë¡ ê´€ë ¨ ë¡œì§ ì²˜ë¦¬
- `notification.controller.ts` - ì•Œë¦¼ ê´€ë ¨ ë¡œì§ ì²˜ë¦¬
- `upload.controller.ts` - íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬

**ê¸°ëŠ¥**:

- ìš”ì²­ ë°ì´í„° ê²€ì¦ (Zod ìŠ¤í‚¤ë§ˆ)
- Service ê³„ì¸µ í˜¸ì¶œ
- ì‘ë‹µ ë°ì´í„° ë³€í™˜ ë° ë°˜í™˜
- ì—ëŸ¬ ì²˜ë¦¬

---

### ğŸ“ `services/` - ì„œë¹„ìŠ¤ ê³„ì¸µ (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)

- `UserService.ts` - ì‚¬ìš©ì ê´€ë ¨ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
  - íšŒì›ê°€ì… ì‹œ ë¹„ë°€ë²ˆí˜¸ í•´ì‹œí™”
  - ë¡œê·¸ì¸ ì¸ì¦ ì²˜ë¦¬
  - ì‹ ë¢°ì ìˆ˜ ê³„ì‚° ë° ì—…ë°ì´íŠ¸

- `PostService.ts` - ê²Œì‹œê¸€ ê´€ë ¨ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
  - ê²Œì‹œê¸€ ìƒì„±/ìˆ˜ì •/ì‚­ì œ
  - ìƒíƒœ ë³€ê²½ ë¡œì§
  - ì°¸ì—¬ì ê´€ë¦¬
  - ì¹´í…Œê³ ë¦¬ í•„í„°ë§

- `ChatService.ts` - ì±„íŒ… ê´€ë ¨ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
  - ì±„íŒ…ë°© ìƒì„± ë° ê´€ë¦¬
  - ë©”ì‹œì§€ ì „ì†¡ ë° ì½ìŒ ì²˜ë¦¬
  - Socket.io ì‹¤ì‹œê°„ í†µì‹  ì—°ë™

- `FavoriteService.ts` - ê´€ì‹¬ ë“±ë¡ ê´€ë ¨ ë¡œì§
- `NotificationService.ts` - ì•Œë¦¼ ìƒì„± ë° ê´€ë¦¬

**ê¸°ëŠ¥**:

- ë„ë©”ì¸ ê·œì¹™ ì²˜ë¦¬
- Repository ê³„ì¸µ í˜¸ì¶œ
- íŠ¸ëœì­ì…˜ ê´€ë¦¬
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê²€ì¦

---

### ğŸ“ `repos/` - Repository ê³„ì¸µ (ë°ì´í„° ì ‘ê·¼)

- `UserRepo.ts` - ì‚¬ìš©ì ë°ì´í„° ì ‘ê·¼
- `PostRepo.ts` - ê²Œì‹œê¸€ ë°ì´í„° ì ‘ê·¼
- `ChatRoomRepo.ts` - ì±„íŒ…ë°© ë°ì´í„° ì ‘ê·¼
- `MessageRepo.ts` - ë©”ì‹œì§€ ë°ì´í„° ì ‘ê·¼
- `FavoriteRepo.ts` - ê´€ì‹¬ ë“±ë¡ ë°ì´í„° ì ‘ê·¼
- `NotificationRepo.ts` - ì•Œë¦¼ ë°ì´í„° ì ‘ê·¼
- `PostParticipantRepo.ts` - ê²Œì‹œê¸€ ì°¸ì—¬ì ë°ì´í„° ì ‘ê·¼

**ê¸°ëŠ¥**:

- Sequelize ORMì„ í†µí•œ ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬
- ë³µì¡í•œ JOIN ë° ì§‘ê³„ ì¿¼ë¦¬ ì²˜ë¦¬
- ë°ì´í„° ë³€í™˜ ë° ë§¤í•‘

---

### ğŸ“ `models/` - ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸

- `User.ts` - ì‚¬ìš©ì ëª¨ë¸
  - í•„ë“œ: id, email, passwordHash, nickname, studentId, department, avatarUrl, trustScore

- `Post.ts` - ê²Œì‹œê¸€ ëª¨ë¸
  - í•„ë“œ: id, authorId, title, content, price, minParticipants, currentQuantity, status, deadline, pickupLocation, category

- `PostImage.ts` - ê²Œì‹œê¸€ ì´ë¯¸ì§€ ëª¨ë¸
- `ChatRoom.ts` - ì±„íŒ…ë°© ëª¨ë¸
- `Message.ts` - ë©”ì‹œì§€ ëª¨ë¸
- `PostParticipant.ts` - ê²Œì‹œê¸€ ì°¸ì—¬ì ëª¨ë¸
- `Favorite.ts` - ê´€ì‹¬ ë“±ë¡ ëª¨ë¸
- `Notification.ts` - ì•Œë¦¼ ëª¨ë¸

**ê¸°ëŠ¥**:

- Sequelize ëª¨ë¸ ì •ì˜
- í…Œì´ë¸” ê´€ê³„ ì„¤ì • (Association)
- ë°ì´í„° íƒ€ì… ë° ì œì•½ì¡°ê±´ ì •ì˜

---

### ğŸ“ `config/` - ì„¤ì • íŒŒì¼

- `passport.ts` - Passport.js ì¸ì¦ ì„¤ì •
  - Local Strategy (í•™ë²ˆ + ë¹„ë°€ë²ˆí˜¸)
  - Kakao Strategy (ì¹´ì¹´ì˜¤ ì†Œì…œ ë¡œê·¸ì¸)

- `socket.ts` - Socket.io ì„¤ì •
  - ì‹¤ì‹œê°„ ì±„íŒ… ì—°ê²° ê´€ë¦¬
  - ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì„¤ì •

- `multer.ts` - íŒŒì¼ ì—…ë¡œë“œ ì„¤ì •
  - ì´ë¯¸ì§€ ì—…ë¡œë“œ ë””ë ‰í† ë¦¬ ì„¤ì •
  - íŒŒì¼ íƒ€ì… ë° í¬ê¸° ì œí•œ

- `swagger.ts` - Swagger API ë¬¸ì„œ ì„¤ì •

---

### ğŸ“ `views/` - í”„ë¡ íŠ¸ì—”ë“œ ë·° íŒŒì¼

- `index.html` - ë©”ì¸ ëŒ€ì‹œë³´ë“œ ë° ìƒí’ˆ ëª©ë¡ í˜ì´ì§€
- `posts.html` - ë‚´ ìƒí’ˆ ê´€ë¦¬ í˜ì´ì§€
- `users.html` - íšŒì› ê´€ë¦¬ í˜ì´ì§€
- `chat.html` - ì±„íŒ… í˜ì´ì§€

---

### ğŸ“ `public/` - ì •ì  íŒŒì¼

#### ğŸ“ `public/scripts/` - í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ JavaScript

- `main.js` - ë©”ì¸ í˜ì´ì§€ ì¸í„°ë™ì…˜ ë¡œì§
  - ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ ë° í‘œì‹œ
  - ê²Œì‹œê¸€ ë“±ë¡/ìˆ˜ì •/ì‚­ì œ
  - ê³µë™êµ¬ë§¤ ì°¸ì—¬
  - ê´€ì‹¬ ë“±ë¡/í•´ì œ
  - Handlebars í…œí”Œë¦¿ ë Œë”ë§

- `posts.js` - ê²Œì‹œê¸€ ê´€ë¦¬ í˜ì´ì§€ ë¡œì§
- `users.js` - íšŒì› ê´€ë¦¬ í˜ì´ì§€ ë¡œì§

#### ğŸ“ `public/stylesheets/` - CSS ìŠ¤íƒ€ì¼ì‹œíŠ¸

- `main.css` - ê³µí†µ ìŠ¤íƒ€ì¼
- `posts.css` - ê²Œì‹œê¸€ ê´€ë ¨ ìŠ¤íƒ€ì¼
- `users.css` - íšŒì› ê´€ë ¨ ìŠ¤íƒ€ì¼

#### ğŸ“ `public/uploads/images/` - ì—…ë¡œë“œëœ ì´ë¯¸ì§€ ì €ì¥ì†Œ

---

### ğŸ“ `common/` - ê³µí†µ ìœ í‹¸ë¦¬í‹°

- `constants/ENV.ts` - í™˜ê²½ ë³€ìˆ˜ ìƒìˆ˜
- `constants/HttpStatusCodes.ts` - HTTP ìƒíƒœ ì½”ë“œ
- `constants/Paths.ts` - API ê²½ë¡œ ìƒìˆ˜
- `util/route-errors.ts` - ë¼ìš°íŠ¸ ì—ëŸ¬ ì²˜ë¦¬
- `util/misc.ts` - ê¸°íƒ€ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜

---

### ğŸ“ `db/` - ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •

- `index.ts` - Sequelize ì¸ìŠ¤í„´ìŠ¤ ë° ì—°ê²° ì„¤ì •

---

## 3. ì¶”ê°€ ê¸°ëŠ¥ (ê°•ì¡° ì„¤ëª…)

### ğŸ¯ **ì‹¤ì‹œê°„ ì±„íŒ… ê¸°ëŠ¥ (WebSocket)**

- Socket.ioë¥¼ í™œìš©í•œ ì‹¤ì‹œê°„ ì–‘ë°©í–¥ í†µì‹ 
- ê²Œì‹œê¸€ë³„ ì±„íŒ…ë°© ìë™ ìƒì„±
- ì½ìŒ/ì•ˆ ì½ìŒ ìƒíƒœ ê´€ë¦¬
- ì‹¤ì‹œê°„ ë©”ì‹œì§€ ì•Œë¦¼

### â­ **ì‹ ë¢°ì ìˆ˜ ì‹œìŠ¤í…œ (Trust Score)**

- ì‚¬ìš©ìì˜ ê³µë™êµ¬ë§¤ í™œë™ ê¸°ë°˜ ì‹ ë¢°ë„ ìˆ˜ì¹˜í™”
- í™œë™ì— ë”°ë¥¸ ìë™ ì ìˆ˜ ì¡°ì •
- ë“±ê¸‰ ì‹œìŠ¤í…œ (ìµœìš°ìˆ˜/ìš°ìˆ˜/ë³´í†µ/ì£¼ì˜/ê²½ê³ )
- ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ê±°ë˜ ìƒëŒ€ë°© ì‹ë³„ ê°€ëŠ¥

### ğŸ—‚ï¸ **ì¹´í…Œê³ ë¦¬ í•„í„°ë§**

- 6ê°€ì§€ ì¹´í…Œê³ ë¦¬ ì œê³µ (ë¨¹ê±°ë¦¬, ì¼ìƒìš©í’ˆ, ë·°í‹°Â·íŒ¨ì…˜, ì „ìê¸°ê¸°, í•™ìš©í’ˆ, í”„ë¦¬ë§ˆì¼“)
- ì¹´í…Œê³ ë¦¬ë³„ ê²Œì‹œê¸€ í•„í„°ë§ ë° ê²€ìƒ‰
- API ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¥¼ í†µí•œ í•„í„°ë§

### ğŸ” **ì†Œì…œ ë¡œê·¸ì¸ (Kakao)**

- Passport.jsë¥¼ í†µí•œ ì¹´ì¹´ì˜¤ OAuth ì¸ì¦
- ì„¸ì…˜ ê¸°ë°˜ ì¸ì¦ ê´€ë¦¬
- ê¸°ì¡´ Local ë¡œê·¸ì¸ê³¼ ë³‘í–‰ ì§€ì›

### ğŸ“ **API ë¬¸ì„œí™” (Swagger)**

- OpenAPI 3.0 ìŠ¤í™ ê¸°ë°˜ API ë¬¸ì„œ
- ì¸í„°ë™í‹°ë¸Œ API í…ŒìŠ¤íŠ¸ í™˜ê²½ ì œê³µ
- ë™ì  ì„œë²„ URL ì§€ì›

---

## 4. ì‚¬ìš©ì ì¸í„°ë ‰ì…˜ì— ëŒ€í•œ ì„œë²„ì˜ ì„œë¹„ìŠ¤ ë„ì‹í™”

### ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```mermaid
flowchart TB
    subgraph Client["í´ë¼ì´ì–¸íŠ¸ (ë¸Œë¼ìš°ì €)"]
        View["HTML Views<br/>(index.html, posts.html, etc.)"]
        Script["JavaScript<br/>(main.js, posts.js, etc.)"]
        Socket["Socket.io Client"]
    end

    subgraph Express["Express ì„œë²„"]
        Middleware["ë¯¸ë“¤ì›¨ì–´<br/>(CORS, Body Parser, Session)"]
        Router["ë¼ìš°í„°<br/>(/api/*)"]
        Controller["ì»¨íŠ¸ë¡¤ëŸ¬<br/>(ìš”ì²­ ê²€ì¦, ì²˜ë¦¬)"]
        Service["ì„œë¹„ìŠ¤ ê³„ì¸µ<br/>(ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)"]
        Repo["Repository ê³„ì¸µ<br/>(ë°ì´í„° ì ‘ê·¼)"]
    end

    subgraph Database["ë°ì´í„°ë² ì´ìŠ¤"]
        MySQL["MySQL<br/>(Sequelize ORM)"]
    end

    subgraph RealTime["ì‹¤ì‹œê°„ í†µì‹ "]
        SocketIO["Socket.io Server"]
    end

    View -->|ì‚¬ìš©ì ì¸í„°ë ‰ì…˜| Script
    Script -->|HTTP ìš”ì²­<br/>(fetch API)| Router
    Router -->|ë¼ìš°íŒ…| Controller
    Controller -->|ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í˜¸ì¶œ| Service
    Service -->|ë°ì´í„° ì ‘ê·¼| Repo
    Repo -->|SQL ì¿¼ë¦¬| MySQL
    MySQL -->|ë°ì´í„° ë°˜í™˜| Repo
    Repo -->|ê²°ê³¼ ë°˜í™˜| Service
    Service -->|ì²˜ë¦¬ ê²°ê³¼| Controller
    Controller -->|JSON ì‘ë‹µ| Script
    Script -->|DOM ì—…ë°ì´íŠ¸| View

    Socket -->|WebSocket ì—°ê²°| SocketIO
    SocketIO -->|ì‹¤ì‹œê°„ ë©”ì‹œì§€| Socket
```

---

## 5. ì‚¬ìš©ì ì¸í„°ë ‰ì…˜ ì¢…ë¥˜ë³„ íë¦„ ë„ì‹í™”

### 5.1. ê²Œì‹œê¸€ ë“±ë¡ í”Œë¡œìš°

```mermaid
sequenceDiagram
    participant User as ì‚¬ìš©ì
    participant View as ì›¹ í™”ë©´<br/>(index.html)
    participant Script as í”„ë¡ íŠ¸ ì½”ë“œ<br/>(main.js)
    participant Server as ì„œë²„<br/>(Express)
    participant Service as PostService
    participant DB as MySQL

    User->>View: ê²Œì‹œê¸€ ë“±ë¡ í¼ ì‘ì„± ë° ì œì¶œ
    View->>Script: í¼ ì œì¶œ ì´ë²¤íŠ¸ ê°ì§€
    Script->>Script: ì…ë ¥ ë°ì´í„° ê²€ì¦
    Script->>Server: POST /api/posts<br/>(ê²Œì‹œê¸€ ë°ì´í„°)
    Server->>Server: Controller: ìš”ì²­ ë°ì´í„° ê²€ì¦ (Zod)
    Server->>Service: createPost() í˜¸ì¶œ
    Service->>Service: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬<br/>(ì‘ì„±ì í™•ì¸, ìƒíƒœ ì„¤ì •)
    Service->>DB: INSERT INTO posts
    DB-->>Service: ìƒì„±ëœ ê²Œì‹œê¸€ ë°ì´í„°
    Service-->>Server: ê²Œì‹œê¸€ ê°ì²´ ë°˜í™˜
    Server-->>Script: 201 Created + JSON ì‘ë‹µ
    Script->>Script: ì‘ë‹µ ë°ì´í„° íŒŒì‹±
    Script->>View: ê²Œì‹œê¸€ ëª©ë¡ ìƒˆë¡œê³ ì¹¨<br/>(Handlebars í…œí”Œë¦¿ ë Œë”ë§)
    View->>User: ê²Œì‹œê¸€ ë“±ë¡ ì™„ë£Œ í‘œì‹œ<br/>(Toast ì•Œë¦¼)
```

---

### 5.2. ê³µë™êµ¬ë§¤ ì°¸ì—¬ í”Œë¡œìš°

```mermaid
sequenceDiagram
    participant User as ì‚¬ìš©ì
    participant View as ì›¹ í™”ë©´
    participant Script as í”„ë¡ íŠ¸ ì½”ë“œ<br/>(main.js)
    participant Server as ì„œë²„<br/>(Express)
    participant Service as PostService
    participant Notification as NotificationService
    participant DB as MySQL
    participant Socket as Socket.io

    User->>View: "ì°¸ì—¬í•˜ê¸°" ë²„íŠ¼ í´ë¦­
    View->>Script: í´ë¦­ ì´ë²¤íŠ¸ ê°ì§€
    Script->>Script: ì‚¬ìš©ì ID í™•ì¸
    Script->>Server: POST /api/posts/:id/participate<br/>(userId)
    Server->>Server: Controller: ìš”ì²­ ê²€ì¦
    Server->>Service: joinPost() í˜¸ì¶œ
    Service->>Service: ì°¸ì—¬ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸<br/>(ë§ˆê° ì—¬ë¶€, ì¤‘ë³µ ì°¸ì—¬ ì²´í¬)
    Service->>DB: INSERT INTO post_participants
    Service->>DB: UPDATE posts SET currentQuantity = currentQuantity + 1
    Service->>Notification: ì•Œë¦¼ ìƒì„±<br/>(ì‘ì„±ìì—ê²Œ ì°¸ì—¬ ì•Œë¦¼)
    Notification->>DB: INSERT INTO notifications
    Service->>Socket: ì‹¤ì‹œê°„ ì•Œë¦¼ ì „ì†¡
    Socket->>View: WebSocketìœ¼ë¡œ ì•Œë¦¼ ì „ë‹¬
    Service-->>Server: ì°¸ì—¬ ì„±ê³µ ì‘ë‹µ
    Server-->>Script: 201 Created
    Script->>Script: ì‘ë‹µ ì²˜ë¦¬
    Script->>Server: GET /api/posts/:id<br/>(ì—…ë°ì´íŠ¸ëœ ì°¸ì—¬ì ìˆ˜ ì¡°íšŒ)
    Server-->>Script: í˜„ì¬ ì°¸ì—¬ì ìˆ˜ í¬í•¨ ê²Œì‹œê¸€ ë°ì´í„°
    Script->>View: ì°¸ì—¬ì ìˆ˜ ì—…ë°ì´íŠ¸<br/>(DOM ì¡°ì‘)
    View->>User: ì°¸ì—¬ ì™„ë£Œ í‘œì‹œ<br/>(Toast ì•Œë¦¼ + ì°¸ì—¬ì ìˆ˜ ê°±ì‹ )
```

---

### 5.3. ì‹¤ì‹œê°„ ì±„íŒ… í”Œë¡œìš°

```mermaid
sequenceDiagram
    participant User1 as ì‚¬ìš©ì 1
    participant User2 as ì‚¬ìš©ì 2
    participant View1 as ì‚¬ìš©ì 1 í™”ë©´
    participant View2 as ì‚¬ìš©ì 2 í™”ë©´
    participant Script1 as í”„ë¡ íŠ¸ ì½”ë“œ 1
    participant Script2 as í”„ë¡ íŠ¸ ì½”ë“œ 2
    participant Server as Express ì„œë²„
    participant SocketIO as Socket.io ì„œë²„
    participant Service as ChatService
    participant DB as MySQL

    User1->>View1: ì±„íŒ…ë°© ì…ì¥
    View1->>Script1: Socket.io ì—°ê²° ì‹œì‘
    Script1->>SocketIO: WebSocket ì—°ê²° ìˆ˜ë¦½
    SocketIO-->>Script1: ì—°ê²° ì„±ê³µ

    User1->>View1: ë©”ì‹œì§€ ì…ë ¥ ë° ì „ì†¡
    View1->>Script1: ë©”ì‹œì§€ ì „ì†¡ ì´ë²¤íŠ¸
    Script1->>SocketIO: emit('send_message', messageData)
    SocketIO->>Server: ë©”ì‹œì§€ ì´ë²¤íŠ¸ ìˆ˜ì‹ 
    Server->>Service: sendMessage() í˜¸ì¶œ
    Service->>DB: INSERT INTO messages
    DB-->>Service: ìƒì„±ëœ ë©”ì‹œì§€
    Service->>SocketIO: ë©”ì‹œì§€ ì €ì¥ ì™„ë£Œ
    SocketIO->>SocketIO: ì±„íŒ…ë°© ë‚´ ëª¨ë“  ì‚¬ìš©ìì—ê²Œ ë¸Œë¡œë“œìºìŠ¤íŠ¸
    SocketIO->>Script1: emit('new_message', messageData)
    SocketIO->>Script2: emit('new_message', messageData)
    Script1->>View1: ë©”ì‹œì§€ í‘œì‹œ (ë³¸ì¸ ë©”ì‹œì§€)
    Script2->>View2: ë©”ì‹œì§€ í‘œì‹œ (ìƒëŒ€ë°© ë©”ì‹œì§€)
    View1->>User1: ë©”ì‹œì§€ ì „ì†¡ ì™„ë£Œ
    View2->>User2: ìƒˆ ë©”ì‹œì§€ ìˆ˜ì‹  ì•Œë¦¼
```

---

### 5.4. ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ (ì¹´í…Œê³ ë¦¬ í•„í„°ë§) í”Œë¡œìš°

```mermaid
sequenceDiagram
    participant User as ì‚¬ìš©ì
    participant View as ì›¹ í™”ë©´<br/>(index.html)
    participant Script as í”„ë¡ íŠ¸ ì½”ë“œ<br/>(main.js)
    participant Server as ì„œë²„<br/>(Express)
    participant Service as PostService
    participant DB as MySQL

    User->>View: ì¹´í…Œê³ ë¦¬ í•„í„° ì„ íƒ<br/>(ì˜ˆ: "ë¨¹ê±°ë¦¬")
    View->>Script: í•„í„° ë³€ê²½ ì´ë²¤íŠ¸ ê°ì§€
    Script->>Script: ì„ íƒëœ ì¹´í…Œê³ ë¦¬ ê°’ í™•ì¸
    Script->>Server: GET /api/posts?category=food&limit=20&offset=0
    Server->>Server: Controller: ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° íŒŒì‹±
    Server->>Service: getAllPosts(category, limit, offset) í˜¸ì¶œ
    Service->>Service: ì¹´í…Œê³ ë¦¬ í•„í„°ë§ ë¡œì§
    Service->>DB: SELECT * FROM posts<br/>WHERE category = 'food'<br/>LIMIT 20 OFFSET 0
    DB-->>Service: í•„í„°ë§ëœ ê²Œì‹œê¸€ ëª©ë¡
    Service->>Service: ê° ê²Œì‹œê¸€ì˜ ì´ë¯¸ì§€, ì‘ì„±ì ì •ë³´ JOIN
    Service-->>Server: ê²Œì‹œê¸€ ë°°ì—´ ë°˜í™˜
    Server-->>Script: 200 OK + JSON ë°°ì—´
    Script->>Script: ì‘ë‹µ ë°ì´í„° íŒŒì‹±
    Script->>Script: Handlebars í…œí”Œë¦¿ ë Œë”ë§
    Script->>View: ê²Œì‹œê¸€ ëª©ë¡ DOM ì—…ë°ì´íŠ¸
    View->>User: í•„í„°ë§ëœ ê²Œì‹œê¸€ ëª©ë¡ í‘œì‹œ
```

---

### 5.5. ë¡œê·¸ì¸ í”Œë¡œìš° (Local Strategy)

```mermaid
sequenceDiagram
    participant User as ì‚¬ìš©ì
    participant View as ì›¹ í™”ë©´<br/>(users.html)
    participant Script as í”„ë¡ íŠ¸ ì½”ë“œ<br/>(users.js)
    participant Server as Express ì„œë²„
    participant Passport as Passport.js
    participant Service as UserService
    participant DB as MySQL

    User->>View: ë¡œê·¸ì¸ ëª¨ë‹¬ì—ì„œ<br/>í•™ë²ˆ, ë¹„ë°€ë²ˆí˜¸ ì…ë ¥
    View->>Script: ë¡œê·¸ì¸ í¼ ì œì¶œ
    Script->>Server: POST /auth/login<br/>(studentId, password)
    Server->>Passport: Local Strategy ì¸ì¦
    Passport->>Service: ì‚¬ìš©ì ì¡°íšŒ (í•™ë²ˆ)
    Service->>DB: SELECT * FROM users<br/>WHERE studentId = ?
    DB-->>Service: ì‚¬ìš©ì ë°ì´í„°
    Service->>Service: ë¹„ë°€ë²ˆí˜¸ ê²€ì¦<br/>(bcrypt.compare)
    alt ë¹„ë°€ë²ˆí˜¸ ì¼ì¹˜
        Service-->>Passport: ì‚¬ìš©ì ê°ì²´ ë°˜í™˜
        Passport->>Server: ì„¸ì…˜ ìƒì„±
        Server-->>Script: 200 OK + ì„¸ì…˜ ì¿ í‚¤
        Script->>Script: ë¡œê·¸ì¸ ì„±ê³µ ì²˜ë¦¬
        Script->>Server: GET /api/users/:id<br/>(í˜„ì¬ ì‚¬ìš©ì ì •ë³´)
        Server-->>Script: ì‚¬ìš©ì ì •ë³´ JSON
        Script->>View: ì‚¬ìš©ì ì •ë³´ í‘œì‹œ<br/>(ë‹‰ë„¤ì„, ì‹ ë¢°ì ìˆ˜ ë“±)
        View->>User: ë¡œê·¸ì¸ ì™„ë£Œ í‘œì‹œ
    else ë¹„ë°€ë²ˆí˜¸ ë¶ˆì¼ì¹˜
        Service-->>Passport: null ë°˜í™˜
        Passport-->>Server: ì¸ì¦ ì‹¤íŒ¨
        Server-->>Script: 401 Unauthorized
        Script->>View: ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
        View->>User: ë¡œê·¸ì¸ ì‹¤íŒ¨ ì•Œë¦¼
    end
```

---

### 5.6. ê´€ì‹¬ ë“±ë¡ í”Œë¡œìš°

```mermaid
sequenceDiagram
    participant User as ì‚¬ìš©ì
    participant View as ì›¹ í™”ë©´
    participant Script as í”„ë¡ íŠ¸ ì½”ë“œ<br/>(main.js)
    participant Server as ì„œë²„<br/>(Express)
    participant Service as FavoriteService
    participant DB as MySQL

    User->>View: "ê´€ì‹¬ ë“±ë¡" ë²„íŠ¼ í´ë¦­
    View->>Script: í´ë¦­ ì´ë²¤íŠ¸ ê°ì§€
    Script->>Script: í˜„ì¬ ì‚¬ìš©ì ID í™•ì¸
    Script->>Server: POST /api/posts/:postId/favorite<br/>(userId)
    Server->>Server: Controller: ìš”ì²­ ê²€ì¦
    Server->>Service: addFavorite() í˜¸ì¶œ
    Service->>Service: ì¤‘ë³µ ë“±ë¡ í™•ì¸
    alt ì´ë¯¸ ê´€ì‹¬ ë“±ë¡ë¨
        Service-->>Server: 400 Bad Request
        Server-->>Script: ì—ëŸ¬ ì‘ë‹µ
        Script->>View: ì´ë¯¸ ë“±ë¡ëœ ë©”ì‹œì§€ í‘œì‹œ
    else ê´€ì‹¬ ë“±ë¡ ê°€ëŠ¥
        Service->>DB: INSERT INTO favorites
        DB-->>Service: ìƒì„±ëœ favorite ë ˆì½”ë“œ
        Service->>DB: UPDATE posts SET favoriteCount = favoriteCount + 1
        Service-->>Server: ê´€ì‹¬ ë“±ë¡ ì„±ê³µ
        Server-->>Script: 201 Created
        Script->>Script: ì‘ë‹µ ì²˜ë¦¬
        Script->>View: ë²„íŠ¼ ìƒíƒœ ë³€ê²½<br/>("ê´€ì‹¬ í•´ì œ"ë¡œ ë³€ê²½)
        Script->>View: ê´€ì‹¬ ê°œìˆ˜ ì—…ë°ì´íŠ¸
        View->>User: ê´€ì‹¬ ë“±ë¡ ì™„ë£Œ í‘œì‹œ<br/>(Toast ì•Œë¦¼)
    end
```

---

### 5.7. ì´ë¯¸ì§€ ì—…ë¡œë“œ í”Œë¡œìš°

```mermaid
sequenceDiagram
    participant User as ì‚¬ìš©ì
    participant View as ì›¹ í™”ë©´
    participant Script as í”„ë¡ íŠ¸ ì½”ë“œ<br/>(main.js)
    participant Server as Express ì„œë²„
    participant Multer as Multer ë¯¸ë“¤ì›¨ì–´
    participant Controller as UploadController
    participant FS as íŒŒì¼ ì‹œìŠ¤í…œ

    User->>View: ì´ë¯¸ì§€ íŒŒì¼ ì„ íƒ<br/>(input type="file")
    View->>Script: íŒŒì¼ ì„ íƒ ì´ë²¤íŠ¸
    Script->>Script: íŒŒì¼ ìœ íš¨ì„± ê²€ì¦<br/>(íƒ€ì…, í¬ê¸°)
    Script->>Server: POST /api/upload/image<br/>(multipart/form-data)
    Server->>Multer: íŒŒì¼ ì—…ë¡œë“œ ë¯¸ë“¤ì›¨ì–´
    Multer->>Multer: íŒŒì¼ íƒ€ì… ë° í¬ê¸° ê²€ì¦
    Multer->>FS: íŒŒì¼ ì €ì¥<br/>(public/uploads/images/)
    FS-->>Multer: ì €ì¥ ì™„ë£Œ (íŒŒì¼ ê²½ë¡œ)
    Multer->>Controller: req.file ì „ë‹¬
    Controller->>Controller: íŒŒì¼ URL ìƒì„±<br/>(http://domain/uploads/images/filename)
    Controller-->>Server: íŒŒì¼ URL ë°˜í™˜
    Server-->>Script: 200 OK + { imageUrl: "..." }
    Script->>Script: ì‘ë‹µ URL ì €ì¥
    Script->>View: ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ<br/>(img íƒœê·¸ src ì—…ë°ì´íŠ¸)
    Script->>View: ê²Œì‹œê¸€ ë“±ë¡ ì‹œ<br/>ì´ë¯¸ì§€ URL í¬í•¨
    View->>User: ì´ë¯¸ì§€ ì—…ë¡œë“œ ì™„ë£Œ í‘œì‹œ
```

---

## 6. ì£¼ìš” ë°ì´í„°ë² ì´ìŠ¤ ê´€ê³„

```mermaid
erDiagram
    User ||--o{ Post : "ì‘ì„±"
    User ||--o{ PostParticipant : "ì°¸ì—¬"
    User ||--o{ Favorite : "ê´€ì‹¬ë“±ë¡"
    User ||--o{ Message : "ë©”ì‹œì§€ì „ì†¡"
    User ||--o{ Notification : "ì•Œë¦¼ìˆ˜ì‹ "

    Post ||--o{ PostImage : "ì´ë¯¸ì§€"
    Post ||--o{ PostParticipant : "ì°¸ì—¬ì"
    Post ||--o{ Favorite : "ê´€ì‹¬ë“±ë¡"
    Post ||--o{ ChatRoom : "ì±„íŒ…ë°©"

    ChatRoom ||--o{ Message : "ë©”ì‹œì§€"

    Post {
        uuid id PK
        uuid authorId FK
        string title
        text content
        decimal price
        int minParticipants
        int currentQuantity
        string status
        datetime deadline
        string category
    }

    User {
        uuid id PK
        string email
        string passwordHash
        string nickname
        string studentId UK
        int trustScore
    }

    ChatRoom {
        uuid id PK
        uuid postId FK
    }

    Message {
        uuid id PK
        uuid chatRoomId FK
        uuid senderId FK
        text content
        boolean isRead
    }
```

---

## 7. í”„ë¡œì íŠ¸ ì‹¤í–‰ ë°©ë²•

### ê°œë°œ í™˜ê²½ ì„¤ì •

```bash
# 1. ì˜ì¡´ì„± ì„¤ì¹˜
npm install

# 2. í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (.env íŒŒì¼ ìƒì„±)
DB_HOST=localhost
DB_PORT=3306
DB_NAME=damara
DB_USER=root
DB_PASSWORD=your_password
NODE_ENV=development
PORT=3000

# 3. ê°œë°œ ì„œë²„ ì‹¤í–‰
npm run dev

# 4. í”„ë¡œë•ì…˜ ë¹Œë“œ
npm run build
npm start
```

### ì ‘ì† URL

- **ë©”ì¸ í˜ì´ì§€**: `http://localhost:3000/`
- **ê²Œì‹œê¸€ ê´€ë¦¬**: `http://localhost:3000/posts`
- **íšŒì› ê´€ë¦¬**: `http://localhost:3000/users`
- **ì±„íŒ…**: `http://localhost:3000/chat`
- **API ë¬¸ì„œ**: `http://localhost:3000/api-docs`

---

## 8. í”„ë¡œì íŠ¸ íŠ¹ì§• ìš”ì•½

### âœ… **ê³„ì¸µì  ì•„í‚¤í…ì²˜**

- Controller â†’ Service â†’ Repository â†’ Model ê³„ì¸µ ë¶„ë¦¬
- ê° ê³„ì¸µì˜ ì±…ì„ ëª…í™•í™”
- ì½”ë“œ ì¬ì‚¬ìš©ì„± ë° ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ

### âœ… **íƒ€ì… ì•ˆì •ì„±**

- TypeScriptë¥¼ í†µí•œ íƒ€ì… ê²€ì¦
- ì»´íŒŒì¼ íƒ€ì„ ì—ëŸ¬ ë°©ì§€

### âœ… **ì‹¤ì‹œê°„ í†µì‹ **

- Socket.ioë¥¼ í†µí•œ ì–‘ë°©í–¥ ì‹¤ì‹œê°„ í†µì‹ 
- ì±„íŒ…, ì•Œë¦¼ ë“± ì¦‰ê°ì ì¸ í”¼ë“œë°± ì œê³µ

### âœ… **ë³´ì•ˆ**

- Passport.jsë¥¼ í†µí•œ ì•ˆì „í•œ ì¸ì¦
- ë¹„ë°€ë²ˆí˜¸ í•´ì‹œí™” (bcrypt)
- ì„¸ì…˜ ê¸°ë°˜ ì¸ì¦ ê´€ë¦¬

### âœ… **í™•ì¥ì„±**

- ëª¨ë“ˆí™”ëœ êµ¬ì¡°
- Swaggerë¥¼ í†µí•œ API ë¬¸ì„œí™”
- í˜ì´ì§• ë° í•„í„°ë§ ì§€ì›

---

**ë¬¸ì„œ ì‘ì„±ì¼**: 2025ë…„ 11ì›” 24ì¼  
**í”„ë¡œì íŠ¸ ë²„ì „**: 0.0.0

